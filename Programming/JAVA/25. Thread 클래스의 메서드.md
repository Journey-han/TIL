## 21. Thread  í´ë˜ìŠ¤ì˜ ì—¬ëŸ¬ ë©”ì„œë“œë“¤

- Thread.MIN_PRIORITY(=1) ~ Thread.MAX_PRIORITY(=10)
- ë””í´íŠ¸ ìš°ì„ ìˆœìœ„ : Thread.NORMAL_PRIORITY(=5)
- ìš°ì„  ìˆœìœ„ê°€ ë†’ì€ Threadê°€ CPUì˜ ë°°ë¶„ì„ ë°›ì„ í™•ë¥ ì´ ë†’ë‹¤
- setPriority()/getPriority()
- Thread ìš°ì„ ìˆœìœ„ ì˜ˆì œ

```java
class PriorityThread extends Thread {
    public void run() {

        int sum = 0;

        Thread t = Thread.currentThread();
        System.out.println(t + "start");

        for (int i = 0; i <= 1000000; i++) {
            sum += i;
        }
        System.out.println(t.getPriority() + "end");
    }
}

public class PriorityTest {
    public static void main(String[] args) {

        int i;
        for (i = Thread.MIN_PRIORITY; i <= Thread.MAX_PRIORITY; i++) {

            PriorityThread pt = new PriorityThread();
            pt.setPriority(i);
            pt.start();
        }
    }
}
```

- ê²°ê³¼

![2.png](https://t1.daumcdn.net/cafeattach/1Dzpp/46d132ee54bc273cd29fe2d816fba238b3c34950)

```java
public class PriorityTest {
    public static void main(String[] args) {

        int i;
       // for (i = Thread.MIN_PRIORITY; i <= Thread.MAX_PRIORITY; i++) {

            PriorityThread pt1 = new PriorityThread();
            PriorityThread pt2 = new PriorityThread();
            PriorityThread pt3 = new PriorityThread();

            pt1.setPriority(Thread.MIN_PRIORITY);
            pt2.setPriority(Thread.NORM_PRIORITY);
            pt3.setPriority(Thread.MAX_PRIORITY);

            pt1.start();
            pt2.start();
            pt3.start();
       // }
    }
}
```

- ê²°ê³¼

![á„‰á…³4.png](https://t1.daumcdn.net/cafeattach/1Dzpp/b970e1e2eb0faaae60902327b102713f493cc9c4)

### join()

- ë™ì‹œì— ë‘ ê°œ ì´ìƒì˜ Threadê°€ ì‹¤í–‰ ë  ë•Œ ë‹¤ë¥¸ Threadì˜ ê²°ê³¼ë¥¼ ì°¸ì¡° í•˜ì—¬ ì‹¤í–‰í•´ì•¼ í•˜ëŠ” ê²½ìš° join() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤.
- join() í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œ Threadê°€ not-runnable ìƒíƒœê°€ ê°„ë‹¤.
- ë‹¤ë¥¸ Threadì˜ ìˆ˜í–‰ì´ ëë‚˜ë©´ runnable ìƒíƒœë¡œ ëŒì•„ì˜¨ë‹¤.

![Untitled](https://t1.daumcdn.net/cafeattach/1Dzpp/f915a88f4ecbc11aecb37b1317691e2ea6dba7b4)

- 1 ë¶€í„° 50, 51 ë¶€í„° 100 ê¹Œì§€ì˜ í•©ì„ êµ¬í•˜ëŠ” ë‘ ê°œì˜ Threadë¥¼ ë§Œë“¤ì–´ ê·¸ ê²°ê³¼ë¥¼ í™•ì¸í•´ ë³´ì„¸ìš”.

```java
public class JoinTest extends Thread {

    int start;
    int end;
    int total;

    public JoinTest(int start, int end) {
        this.start = start;
        this.end = end;
    }

    public void run() {

        int i;
        for (i = start; i <= end; i++) {
            total +=i;
        }
    }

    public static void main(String[] args) {

        JoinTest jt1 = new JoinTest(1, 50);
        JoinTest jt2 = new JoinTest(51, 100);

        jt1.start();
        jt2.start();

        try {
            jt1.join();
            jt2.join();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }

        int lastTotal = jt1.total + jt2.total;

        System.out.println("jt1.total = " + jt1.total);
        System.out.println("jt2.total = " + jt2.total);

        System.out.println("lastTotal = " + lastTotal);

    }
}
```

- ê²°ê³¼

![á„‰á…³7.png](https://t1.daumcdn.net/cafeattach/1Dzpp/c18df470ab113bdce09f35c9d399fe9cc7f9f736)

### interrupt()

- ë‹¤ë¥¸ Threadì— ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚¤ëŠ” interruptë¥¼ ë³´ë‚¸ë‹¤.
- Threadê°€ join(), sleep(), wait() í•¨ìˆ˜ì—ì˜í•´ not-runnable ìƒíƒœì¼ ë•Œ interrupt() ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©´ ë‹¤ì‹œ runnable ìƒíƒœê°€ ë  ìˆ˜ ìˆë‹¤.

### Thread ì¢…ë£Œí•˜ê¸°

- Threadë¥¼ ì¢…ë£Œí•  ë•Œ ì‚¬ìš©í•œë‹¤.
- ë¬´í•œ ë°˜ë³µì˜ ê²½ìš° while(flag)ì˜ flag ë³€ìˆ˜ê°’ì„ falseë¡œ ë°”ê¾¸ì–´ ì¢…ë£Œë¥¼ ì‹œí‚¨ë‹¤.
- Thread ì¢…ë£Œí•˜ê¸° ì˜ˆì œ

> ğŸ’¡ ì„¸ ê°œì˜ threadë¥¼ ë§Œë“ ë‹¤.       
>   ê°ê° ë¬´í•œ ë£¨í”„ë¥¼ ìˆ˜í–‰í•˜ê²Œ í•œë‹¤.     
>   ì‘ì—… ë‚´ìš© this.sleep(100);      
>
>   â€˜Aâ€™ ë¥¼ ì…ë ¥ ë°›ìœ¼ë©´ ì²« ë²ˆì§¸ threadë¥¼     
>    â€˜Bâ€™ ë¥¼ ì…ë ¥ ë°›ìœ¼ë©´ ë‘ ë²ˆì§¸ threadë¥¼        
>   â€˜Câ€™ ë¥¼ ì…ë ¥ ë°›ìœ¼ë©´ ì„¸ ë²ˆì§¸ threadë¥¼     
>   â€˜Mâ€™ì„ ì…ë ¥ ë°›ìœ¼ë©´ ëª¨ë“  threadì™€ main() í•¨ìˆ˜ë¥¼ ì¢…ë£Œí•œë‹¤.     

```java
import java.io.IOException;

public class TerminateThread extends Thread{

    private boolean flag = false;
    int i;

    public TerminateThread(String name){
        super(name);
    }

    public void run(){

        while(!flag){
            try {
                sleep(100);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }

        System.out.println( getName() + " end" );

    }

    public void setFlag(boolean flag){
        this.flag = flag;
    }

    public static void main(String[] args) throws IOException {

        TerminateThread threadA = new TerminateThread("A");
        TerminateThread threadB = new TerminateThread("B");
        TerminateThread threadC = new TerminateThread("C");

        threadA.start();
        threadB.start();
        threadC.start();

        int in;
        while(true){
            in = System.in.read();
            if ( in == 'A'){
                threadA.setFlag(true);
            }else if(in == 'B'){
                threadB.setFlag(true);
            }else if( in == 'C'){
                threadC.setFlag(true);
            }else if( in == 'M'){
                threadA.setFlag(true);
                threadB.setFlag(true);
                threadC.setFlag(true);
                break;
            }else{
                System.out.println("type again");
            }
        }

        System.out.println("main end");

    }
}
```

- ê²°ê³¼

![á„‰á…³1.png](https://t1.daumcdn.net/cafeattach/1Dzpp/c97df6ff29667e39a8b11486fd13be7c1dd48a20)